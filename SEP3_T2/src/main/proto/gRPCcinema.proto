syntax = "proto3";
option java_multiple_files = true;

package grpccinema;


//---------- Customer ----------\\
message DTOCustomer
{
  string name = 1;
  string password = 2;
  string email = 3;
  string phone = 4;
  string role = 5;
}

message GetCustomersRequest
{
}

message GetCustomersResponse
{
  repeated DTOCustomer customers = 1;
}

message GetCustomerByPhoneRequest
{
  string phone = 1;
}

message GetCustomerByPhoneResponse
{
  DTOCustomer customer = 1;
}

message SaveCustomerRequest {
  DTOCustomer customer = 1;
}

message SaveCustomerResponse {
  DTOCustomer customer = 1;
}
message DeleteCustomerRequest {
  string phone = 1;
}
message DeleteCustomerResponse
{
  string phone = 1;
}

message VerifyCustomerPasswordRequest {
  string phone = 1;
  string password = 2;
}

message VerifyCustomerPasswordResponse {
  bool isValid = 1;
}

//---------- Hall ----------\\
message DTOHall{
  int32 id = 1;
  int32 number = 2;
  int32 layout = 3;

}

message GetHallsRequest{}

message GetHallsResponse{
  repeated DTOHall halls = 1;
}

message GetHallByIdRequest{
  int32 id = 1;
}

message GetHallByIdResponse{
  DTOHall hall = 1;
}

//---------- Movie ----------\\

message DTOMovie{
  string title = 1;
  int32 playtime = 2;
  string genre = 3;
  string releaseDate = 4;
  int32 id = 5;
}

message GetMovieByIdRequest{
  int32 id = 1;
}
message GetMovieByIdResponse{
  DTOMovie movie = 1;
}

message GetAllMoviesRequest{}

message GetAllMoviesResponse{
  repeated DTOMovie movies = 1;
}


//---------- Screening ----------\\
message DTOScreening{
  int32 id = 1;
  DTOMovie movie= 2;
  string startTime = 3;
  string date = 4;
  int32 hallId = 5;
  int32 availableSeats = 6;
  DTOHall hall = 7;
}

message GetAllScreeningsRequest{}

message GetAllScreeningsResponse{
  repeated DTOScreening screenings = 1;
}

message GetScreeningByIdRequest{
  int32 id = 1;
}

message GetScreeningByIdResponse{
  DTOScreening screening = 1;
}



//---------- Layout ----------\\

message DTOLayout{
  string maxLetter = 1;
  int32 maxSeatInt = 2;
  int32 id = 3;
}

message GetAllLayoutsRequest{

}
message GetAllLayoutsResponse{
  repeated DTOLayout Layouts = 1;
}


//---------- Layout ----------\\

message DTOSeat{
  string letter = 1;
  int32 number =2;
  int32 id = 3;
  bool booked = 4;
  DTOCustomer customer = 5;
}

message GetAllSeatsRequest{}

message GetAllSeatsResponse{
  repeated DTOSeat seats = 1;
}

message GetSeatsByScreeningRequest {
  int32 screening_id = 1;
}

message GetSeatsByScreeningResponse {
  repeated DTOSeat seats = 1;
}

message BookSeatsRequest {
  int32 screeningId = 1;
  string customerPhone = 2;
  repeated int32 seatIds = 3;
}

message CustomerBooking
{
  int32 screenId = 1;
  string movieTitle = 2;
  string date = 3;
  string time = 4;
  repeated string seats = 5;
  repeated int32 seatIds = 6;
}

message GetBookingsByPhoneRequest{
  string phone =1;
}

message GetBookingByPhoneResponse {
  repeated CustomerBooking bookings = 1;
}



message BookSeatsResponse{}

message UpdateBookingRequest{
  int32 screeningId = 1;
  string customerPhone = 2;
  repeated int32 seatsToAdd = 3;
  repeated int32 seatsToRemove = 4;
}

message UpdateBookingResponse{
  bool success = 1;
  string message = 2;
}

service CinemaService
{
  rpc GetCustomers (GetCustomersRequest) returns (GetCustomersResponse);
  rpc GetCustomerByPhone (GetCustomerByPhoneRequest) returns (GetCustomerByPhoneResponse);
  rpc SaveCustomer(SaveCustomerRequest) returns (SaveCustomerResponse);
  rpc DeleteCustomer(DeleteCustomerRequest) returns (DeleteCustomerResponse);
  rpc GetHalls (GetHallsRequest) returns (GetHallsResponse);
  rpc GetHallByID (GetHallByIdRequest) returns (GetHallByIdResponse);
  rpc GetAllScreenings (GetAllScreeningsRequest) returns (GetAllScreeningsResponse);
  rpc GetMovieByID (GetMovieByIdRequest) returns (GetMovieByIdResponse);
  rpc GetAllMovies (GetAllMoviesRequest) returns (GetAllMoviesResponse);
  rpc GetScreeningByID (GetScreeningByIdRequest) returns (GetScreeningByIdResponse);
  rpc GetAllLayouts (GetAllLayoutsRequest) returns (GetAllLayoutsResponse);
  rpc GetAllSeats (GetAllSeatsRequest) returns (GetAllSeatsResponse);
  rpc GetSeatsByScreening(GetSeatsByScreeningRequest) returns (GetSeatsByScreeningResponse);
  rpc BookSeats(BookSeatsRequest) returns (BookSeatsResponse);
  rpc UpdateBooking(UpdateBookingRequest) returns (UpdateBookingResponse);
  rpc VerifyCustomerPassword(VerifyCustomerPasswordRequest) returns (VerifyCustomerPasswordResponse);
  rpc GetBookingsByPhone(GetBookingsByPhoneRequest) returns (GetBookingByPhoneResponse);
}